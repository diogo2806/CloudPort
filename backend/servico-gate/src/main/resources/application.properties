server.port=${GATE_SERVER_PORT:8082}

spring.application.name=servico-gate

spring.datasource.url=${GATE_DB_URL:jdbc:postgresql://localhost:5432/servico_gate}
spring.datasource.username=${GATE_DB_USERNAME:postgres}
spring.datasource.password=${GATE_DB_PASSWORD:postgres}
spring.datasource.driver-class-name=org.postgresql.Driver
spring.jpa.hibernate.ddl-auto=none
spring.jpa.open-in-view=false
spring.jpa.properties.hibernate.jdbc.lob.non_contextual_creation=true
spring.flyway.enabled=true
spring.flyway.locations=classpath:db/migration

spring.rabbitmq.host=${GATE_RABBIT_HOST:localhost}
spring.rabbitmq.port=${GATE_RABBIT_PORT:5672}
spring.rabbitmq.username=${GATE_RABBIT_USERNAME:guest}
spring.rabbitmq.password=${GATE_RABBIT_PASSWORD:guest}

management.endpoints.web.exposure.include=health,info,metrics
management.endpoint.health.probes.enabled=true
springdoc.api-docs.path=/api-docs
springdoc.swagger-ui.path=/swagger-ui.html

# Configurações de integração com o TOS
cloudport.tos.api.base-url=${TOS_API_BASE_URL:http://localhost:8080}
cloudport.tos.api.timeout=${TOS_API_TIMEOUT_MS:5000}
cloudport.tos.api.booking-path=${TOS_API_BOOKING_PATH:/tos/bookings/{bookingNumber}}
cloudport.tos.api.container-status-path=${TOS_API_CONTAINER_STATUS_PATH:/tos/containers/{containerNumber}/status}
cloudport.tos.api.customs-release-path=${TOS_API_CUSTOMS_RELEASE_PATH:/tos/containers/{containerNumber}/customs}
cloudport.tos.api.username=${TOS_API_USERNAME:}
cloudport.tos.api.password=${TOS_API_PASSWORD:}
cloudport.tos.retry.max-attempts=${TOS_API_RETRY_ATTEMPTS:3}
cloudport.tos.retry.initial-interval=${TOS_API_RETRY_INTERVAL_MS:500}
cloudport.tos.retry.multiplier=${TOS_API_RETRY_MULTIPLIER:2.0}
cloudport.tos.cache.max-size=${TOS_API_CACHE_MAX_SIZE:500}
cloudport.tos.cache.ttl=${TOS_API_CACHE_TTL:PT5M}

# Fluxo de gate e integrações de hardware
cloudport.gate.flow.tolerancia-entrada-antecipada=${GATE_TOL_ENTRADA_ANTEC:PT30M}
cloudport.gate.flow.tolerancia-entrada-atraso=${GATE_TOL_ENTRADA_ATRASO:PT30M}
cloudport.gate.flow.tolerancia-saida-antecipada=${GATE_TOL_SAIDA_ANTEC:PT30M}
cloudport.gate.flow.tolerancia-saida-atraso=${GATE_TOL_SAIDA_ATRASO:PT30M}
cloudport.gate.flow.roles-liberacao-manual=${GATE_ROLES_LIBERACAO_MANUAL:ROLE_SUPERVISOR,ROLE_COORDENADOR,ROLE_ADMIN}

cloudport.gate.hardware.entrada-queue=${GATE_HARDWARE_ENTRADA_QUEUE:gate.hardware.entrada}
cloudport.gate.hardware.saida-queue=${GATE_HARDWARE_SAIDA_QUEUE:gate.hardware.saida}
cloudport.gate.hardware.decisao-exchange=${GATE_HARDWARE_DECISAO_EXCHANGE:gate.hardware.decisao}
cloudport.gate.hardware.decisao-routing-entrada=${GATE_HARDWARE_DECISAO_ROUTING_ENTRADA:gate.hardware.decisao.entrada}
cloudport.gate.hardware.decisao-routing-saida=${GATE_HARDWARE_DECISAO_ROUTING_SAIDA:gate.hardware.decisao.saida}

# Configurações de armazenamento de documentos
cloudport.document-storage.provider=${DOCUMENT_STORAGE_PROVIDER:local}
cloudport.document-storage.base-path=${DOCUMENT_STORAGE_BASE_PATH:/var/lib/cloudport/documents}
cloudport.document-storage.bucket=${DOCUMENT_STORAGE_BUCKET:cloudport-documents}

cloudport.gate.agendamento.rules.antecedencia-minima=${AGENDAMENTO_ANTECEDENCIA_MINIMA:PT2H}
cloudport.gate.agendamento.rules.atraso-maximo=${AGENDAMENTO_ATRASO_MAXIMO:PT1H}
cloudport.gate.agendamento.rules.edicao-antecedencia=${AGENDAMENTO_EDICAO_ANTECEDENCIA:PT12H}
cloudport.gate.agendamento.rules.edicao-atraso=${AGENDAMENTO_EDICAO_ATRASO:PT2H}

# Resilience4j
resilience4j.circuitbreaker.instances.tosApi.register-health-indicator=true
resilience4j.circuitbreaker.instances.tosApi.sliding-window-size=${RESILIENCE4J_TOS_WINDOW_SIZE:10}
resilience4j.circuitbreaker.instances.tosApi.failure-rate-threshold=${RESILIENCE4J_TOS_FAILURE_THRESHOLD:50}
resilience4j.circuitbreaker.instances.tosApi.wait-duration-in-open-state=${RESILIENCE4J_TOS_WAIT_DURATION:PT30S}
